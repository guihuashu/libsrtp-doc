<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libSRTP: Secure RTCP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="docs.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libSRTP
   &#160;<span id="projectnumber">3.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#enumval-members">Enumerator</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Secure RTCP<div class="ingroups"><a class="el" href="group__SRTP.html">Secure RTP</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Secure RTCP functions are used to protect RTCP traffic.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__User"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__User.html">data associated to a SRTP session.</a></td></tr>
<tr class="memdesc:group__User"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store custom user data within a SRTP session. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__SRTPevents"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTPevents.html">SRTP events and callbacks</a></td></tr>
<tr class="memdesc:group__SRTPevents"><td class="mdescLeft">&#160;</td><td class="mdescRight">libSRTP can use a user-provided callback function to handle events. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga67ae04e2a6c46a89b8052937dc0d862c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#ga2d9e365ccac332e03bf4a37e6b84ad76">srtp_err_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga67ae04e2a6c46a89b8052937dc0d862c">srtp_protect_rtcp</a> (<a class="el" href="group__SRTP.html#ga1c404a756add908efb805d6b729994d0">srtp_t</a> ctx, const uint8_t *rtcp, size_t rtcp_len, uint8_t *srtcp, size_t *srtcp_len, size_t mki_index)</td></tr>
<tr class="memdesc:ga67ae04e2a6c46a89b8052937dc0d862c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="group__SRTCP.html#ga67ae04e2a6c46a89b8052937dc0d862c" title="srtp_protect_rtcp() is the Secure RTCP sender-side packet processing function.">srtp_protect_rtcp()</a> is the Secure RTCP sender-side packet processing function.  <a href="group__SRTCP.html#ga67ae04e2a6c46a89b8052937dc0d862c">More...</a><br /></td></tr>
<tr class="separator:ga67ae04e2a6c46a89b8052937dc0d862c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75e71c7cc580c5a627768d36fb2f1b1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#ga2d9e365ccac332e03bf4a37e6b84ad76">srtp_err_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga75e71c7cc580c5a627768d36fb2f1b1e">srtp_unprotect_rtcp</a> (<a class="el" href="group__SRTP.html#ga1c404a756add908efb805d6b729994d0">srtp_t</a> ctx, const uint8_t *srtcp, size_t srtcp_len, uint8_t *rtcp, size_t *rtcp_len)</td></tr>
<tr class="memdesc:ga75e71c7cc580c5a627768d36fb2f1b1e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="group__SRTCP.html#ga75e71c7cc580c5a627768d36fb2f1b1e" title="srtp_unprotect_rtcp() is the Secure RTCP receiver-side packet processing function.">srtp_unprotect_rtcp()</a> is the Secure RTCP receiver-side packet processing function.  <a href="group__SRTCP.html#ga75e71c7cc580c5a627768d36fb2f1b1e">More...</a><br /></td></tr>
<tr class="separator:ga75e71c7cc580c5a627768d36fb2f1b1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gaba1154d59d03e5594291eadf554c482c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#gad70c97ce681acb694ce3caee0c1051e4">srtp_cipher_type_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gaba1154d59d03e5594291eadf554c482c">srtp_crypto_policy_t::cipher_type</a></td></tr>
<tr class="separator:gaba1154d59d03e5594291eadf554c482c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2780cd68077dcf2f1389001bede06b7"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gae2780cd68077dcf2f1389001bede06b7">srtp_crypto_policy_t::cipher_key_len</a></td></tr>
<tr class="separator:gae2780cd68077dcf2f1389001bede06b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga313d1b6811a3e3861ace0f74c6910345"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#gaead974fea9c35a51c1dbf21aa136cd81">srtp_auth_type_id_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga313d1b6811a3e3861ace0f74c6910345">srtp_crypto_policy_t::auth_type</a></td></tr>
<tr class="separator:ga313d1b6811a3e3861ace0f74c6910345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade0944114a3003aabf894ac393e407b8"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gade0944114a3003aabf894ac393e407b8">srtp_crypto_policy_t::auth_key_len</a></td></tr>
<tr class="separator:gade0944114a3003aabf894ac393e407b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab225b82c1acdd6a21e34dd879a4288c4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gab225b82c1acdd6a21e34dd879a4288c4">srtp_crypto_policy_t::auth_tag_len</a></td></tr>
<tr class="separator:gab225b82c1acdd6a21e34dd879a4288c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga407b35adb46bf372962c466ba60ee76d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#gaa27b90c4ad1bc3e874ec8baa805528e2">srtp_sec_serv_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga407b35adb46bf372962c466ba60ee76d">srtp_crypto_policy_t::sec_serv</a></td></tr>
<tr class="separator:ga407b35adb46bf372962c466ba60ee76d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa68453a1aad5a06c462b9ece9899e571"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#ga5f645f22b51783c17b084572a3c821a2">srtp_ssrc_type_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gaa68453a1aad5a06c462b9ece9899e571">srtp_ssrc_t::type</a></td></tr>
<tr class="separator:gaa68453a1aad5a06c462b9ece9899e571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63122ff062c3514a84dfd255e7882ceb"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga63122ff062c3514a84dfd255e7882ceb">srtp_ssrc_t::value</a></td></tr>
<tr class="separator:ga63122ff062c3514a84dfd255e7882ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac75ef5b52a26ff6a3fe22047ba16add5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsrtp__ssrc__t.html">srtp_ssrc_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gac75ef5b52a26ff6a3fe22047ba16add5">srtp_policy_t::ssrc</a></td></tr>
<tr class="separator:gac75ef5b52a26ff6a3fe22047ba16add5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a2bce58e854e44e6d449ec7141b33e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsrtp__crypto__policy__t.html">srtp_crypto_policy_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga7a2bce58e854e44e6d449ec7141b33e2">srtp_policy_t::rtp</a></td></tr>
<tr class="separator:ga7a2bce58e854e44e6d449ec7141b33e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa1847e6734f709f86e79d0600bc4f24f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsrtp__crypto__policy__t.html">srtp_crypto_policy_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gaa1847e6734f709f86e79d0600bc4f24f">srtp_policy_t::rtcp</a></td></tr>
<tr class="separator:gaa1847e6734f709f86e79d0600bc4f24f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa60203e58d672690179771f3461c55d"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gaaa60203e58d672690179771f3461c55d">srtp_policy_t::key</a></td></tr>
<tr class="separator:gaaa60203e58d672690179771f3461c55d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga726519472469427aeab76dfec28fabc1"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga726519472469427aeab76dfec28fabc1">srtp_policy_t::num_master_keys</a></td></tr>
<tr class="separator:ga726519472469427aeab76dfec28fabc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac67dc27a66ff404cadecf1bc4b194843"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gac67dc27a66ff404cadecf1bc4b194843">srtp_policy_t::use_mki</a></td></tr>
<tr class="separator:gac67dc27a66ff404cadecf1bc4b194843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00cb2e33c4f35e2a0b5641bd622a622f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga00cb2e33c4f35e2a0b5641bd622a622f">srtp_policy_t::mki_size</a></td></tr>
<tr class="separator:ga00cb2e33c4f35e2a0b5641bd622a622f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f4319a87f06d8e3edabeb4ffe3390b2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga9f4319a87f06d8e3edabeb4ffe3390b2">srtp_policy_t::window_size</a></td></tr>
<tr class="separator:ga9f4319a87f06d8e3edabeb4ffe3390b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d9af51100a8a1a4f302c18e70f52c51"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga7d9af51100a8a1a4f302c18e70f52c51">srtp_policy_t::allow_repeat_tx</a></td></tr>
<tr class="separator:ga7d9af51100a8a1a4f302c18e70f52c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac2851568631df1b7e41b464c7574bc23"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gac2851568631df1b7e41b464c7574bc23">srtp_policy_t::enc_xtn_hdr</a></td></tr>
<tr class="separator:gac2851568631df1b7e41b464c7574bc23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d5d4b15f58553ee6f83b67018721f52"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga8d5d4b15f58553ee6f83b67018721f52">srtp_policy_t::enc_xtn_hdr_count</a></td></tr>
<tr class="separator:ga8d5d4b15f58553ee6f83b67018721f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e0d2dbb6d41eedb0eb6597f9b7073a8"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsrtp__policy__t.html">srtp_policy_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga6e0d2dbb6d41eedb0eb6597f9b7073a8">srtp_policy_t::next</a></td></tr>
<tr class="separator:ga6e0d2dbb6d41eedb0eb6597f9b7073a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ad798f300e1f0cb78faa415f51e7dde"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTP.html#ga1c404a756add908efb805d6b729994d0">srtp_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga1ad798f300e1f0cb78faa415f51e7dde">srtp_event_data_t::session</a></td></tr>
<tr class="separator:ga1ad798f300e1f0cb78faa415f51e7dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac364ee9d9a3c2c49aba31967925bced5"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#gac364ee9d9a3c2c49aba31967925bced5">srtp_event_data_t::ssrc</a></td></tr>
<tr class="separator:gac364ee9d9a3c2c49aba31967925bced5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6466c86d6d5aafed315230154d50c5f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__SRTPevents.html#gada9b262f3a03e413bce4b5d0476d2ce0">srtp_event_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRTCP.html#ga6466c86d6d5aafed315230154d50c5f4">srtp_event_data_t::event</a></td></tr>
<tr class="separator:ga6466c86d6d5aafed315230154d50c5f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>RTCP is the control protocol for RTP. libSRTP protects RTCP traffic in much the same way as it does RTP traffic. The function <a class="el" href="group__SRTCP.html#ga67ae04e2a6c46a89b8052937dc0d862c" title="srtp_protect_rtcp() is the Secure RTCP sender-side packet processing function.">srtp_protect_rtcp()</a> applies cryptographic protections to outbound RTCP packets, and <a class="el" href="group__SRTCP.html#ga75e71c7cc580c5a627768d36fb2f1b1e" title="srtp_unprotect_rtcp() is the Secure RTCP receiver-side packet processing function.">srtp_unprotect_rtcp()</a> verifies the protections on inbound RTCP packets.</p>
<p>A note on the naming convention: <a class="el" href="group__SRTCP.html#ga67ae04e2a6c46a89b8052937dc0d862c" title="srtp_protect_rtcp() is the Secure RTCP sender-side packet processing function.">srtp_protect_rtcp()</a> has an srtp_t as its first argument, and thus has &lsquo;srtp_&rsquo; as its prefix. The trailing &lsquo;_rtcp&rsquo; indicates the protocol on which it acts. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga67ae04e2a6c46a89b8052937dc0d862c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67ae04e2a6c46a89b8052937dc0d862c">&#9670;&nbsp;</a></span>srtp_protect_rtcp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#ga2d9e365ccac332e03bf4a37e6b84ad76">srtp_err_status_t</a> srtp_protect_rtcp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SRTP.html#ga1c404a756add908efb805d6b729994d0">srtp_t</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>rtcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>rtcp_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>srtcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>srtcp_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mki_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function call srtp_protect_rtcp(ctx, rtcp, rtcp_len, srtcp, srtcp_len, mki_index) applies SRTCP protection to the RTCP packet rtcp (which has length rtcp_len) using the SRTP session context ctx. If srtp_err_status_ok is returned, then srtcp points to the resulting SRTCP packet and *srtcp_len is the number of octets in that packet; otherwise, no assumptions should be made about the value of either data elements.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function assumes that the RTCP packet is aligned on a 32-bit boundary.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>is the SRTP context to use in processing the packet.</td></tr>
    <tr><td class="paramname">rtcp</td><td>is a pointer to the RTCP packet (before the call).</td></tr>
    <tr><td class="paramname">rtcp_len</td><td>is the length in octets of the complete RTCP packet (header and body).</td></tr>
    <tr><td class="paramname">srtcp</td><td>is a pointer to a buffer that after the function returns will contain the complete SRTCP packet. The value of srtcp can be the same as rtcp to support in-place io.</td></tr>
    <tr><td class="paramname">srtcp_len</td><td>is a pointer to the length in octets of the srtcp buffer before the function call, and of the complete SRTCP packet after the call, if srtp_err_status_ok was returned. Otherwise, the value of the data to which it points is undefined.</td></tr>
    <tr><td class="paramname">mki_index</td><td>integer value specifying which set of session keys should be used if use_mki was set to true. Otherwise ignored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>srtp_err_status_ok if there were no problems.</li>
<li>srtp_err_status_buffer_small the srtcp buffer is too small for the SRTCP packet</li>
<li>[other] if there was a failure in the cryptographic mechanisms. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ga75e71c7cc580c5a627768d36fb2f1b1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga75e71c7cc580c5a627768d36fb2f1b1e">&#9670;&nbsp;</a></span>srtp_unprotect_rtcp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#ga2d9e365ccac332e03bf4a37e6b84ad76">srtp_err_status_t</a> srtp_unprotect_rtcp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SRTP.html#ga1c404a756add908efb805d6b729994d0">srtp_t</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>srtcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>srtcp_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rtcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>rtcp_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function call srtp_unprotect_rtcp(ctx, srtcp, srtcp_len, rtcp, rtcp_len) verifies the Secure RTCP protection of the SRTCP packet pointed to by srtcp (which has length srtcp_len), using the SRTP session context ctx. If srtp_err_status_ok is returned, then rtcp points to the resulting RTCP packet and *rtcp_len is the number of octets in that packet; otherwise, no assumptions should be made about the value of either data elements.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function assumes that the SRTCP packet is aligned on a 32-bit boundary.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>is a pointer to the srtp_t which applies to the particular packet.</td></tr>
    <tr><td class="paramname">srtcp</td><td>is a pointer to the header of the SRTCP packet.</td></tr>
    <tr><td class="paramname">srtcp_len</td><td>is the length in octets of the complete SRTCP packet (header and body).</td></tr>
    <tr><td class="paramname">rtcp</td><td>is a pointer to a buffer that after the function returns will contain the complete RTCP packet. The value of rtcp can be the same as srtcp to support in-place io.</td></tr>
    <tr><td class="paramname">rtcp_len</td><td>is a pointer to the length of the rtcp buffer before the function call, and of the complete RTCP packet after the call, if srtp_err_status_ok was returned. Otherwise, the value of the data to which it points is undefined.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>srtp_err_status_ok if the RTCP packet is valid.</li>
<li>srtp_err_status_auth_fail if the SRTCP packet failed the message authentication check.</li>
<li>srtp_err_status_replay_fail if the SRTCP packet is a replay (e.g. has already been processed and accepted).</li>
<li>srtp_err_status_bad_mki if the MKI in the packet is not a known MKI id</li>
<li>[other] if there has been an error in the cryptographic mechanisms. </li>
</ul>
</dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga7d9af51100a8a1a4f302c18e70f52c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7d9af51100a8a1a4f302c18e70f52c51">&#9670;&nbsp;</a></span>allow_repeat_tx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool srtp_policy_t::allow_repeat_tx</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Whether retransmissions of <br  />
 packets with the same sequence <br  />
 number are allowed. <br  />
 (Note that such repeated <br  />
 transmissions must have the same <br  />
 RTP payload, or a severe security <br  />
 weakness is introduced!) <br  />
 </p>

</div>
</div>
<a id="gade0944114a3003aabf894ac393e407b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade0944114a3003aabf894ac393e407b8">&#9670;&nbsp;</a></span>auth_key_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_crypto_policy_t::auth_key_len</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The length of the authentication function key in octets. <br  />
 </p>

</div>
</div>
<a id="gab225b82c1acdd6a21e34dd879a4288c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab225b82c1acdd6a21e34dd879a4288c4">&#9670;&nbsp;</a></span>auth_tag_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_crypto_policy_t::auth_tag_len</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The length of the authentication tag in octets. <br  />
 </p>

</div>
</div>
<a id="ga313d1b6811a3e3861ace0f74c6910345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga313d1b6811a3e3861ace0f74c6910345">&#9670;&nbsp;</a></span>auth_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#gaead974fea9c35a51c1dbf21aa136cd81">srtp_auth_type_id_t</a> srtp_crypto_policy_t::auth_type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An integer representing the <br  />
 authentication function. <br  />
 </p>

</div>
</div>
<a id="gae2780cd68077dcf2f1389001bede06b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae2780cd68077dcf2f1389001bede06b7">&#9670;&nbsp;</a></span>cipher_key_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_crypto_policy_t::cipher_key_len</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The length of the cipher key <br  />
 in octets. <br  />
 </p>

</div>
</div>
<a id="gaba1154d59d03e5594291eadf554c482c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba1154d59d03e5594291eadf554c482c">&#9670;&nbsp;</a></span>cipher_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#gad70c97ce681acb694ce3caee0c1051e4">srtp_cipher_type_id_t</a> srtp_crypto_policy_t::cipher_type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An integer representing <br  />
 the type of cipher. <br  />
 </p>

</div>
</div>
<a id="gac2851568631df1b7e41b464c7574bc23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac2851568631df1b7e41b464c7574bc23">&#9670;&nbsp;</a></span>enc_xtn_hdr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* srtp_policy_t::enc_xtn_hdr</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>List of header ids to encrypt. <br  />
 </p>

</div>
</div>
<a id="ga8d5d4b15f58553ee6f83b67018721f52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d5d4b15f58553ee6f83b67018721f52">&#9670;&nbsp;</a></span>enc_xtn_hdr_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_policy_t::enc_xtn_hdr_count</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of entries in list of header ids. <br  />
 </p>

</div>
</div>
<a id="ga6466c86d6d5aafed315230154d50c5f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6466c86d6d5aafed315230154d50c5f4">&#9670;&nbsp;</a></span>event</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTPevents.html#gada9b262f3a03e413bce4b5d0476d2ce0">srtp_event_t</a> srtp_event_data_t::event</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An enum indicating the type of event. <br  />
 </p>

</div>
</div>
<a id="gaaa60203e58d672690179771f3461c55d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa60203e58d672690179771f3461c55d">&#9670;&nbsp;</a></span>key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* srtp_policy_t::key</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pointer to the SRTP master key for <br  />
 this stream. <br  />
 </p>

</div>
</div>
<a id="ga00cb2e33c4f35e2a0b5641bd622a622f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga00cb2e33c4f35e2a0b5641bd622a622f">&#9670;&nbsp;</a></span>mki_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_policy_t::mki_size</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Whether MKI is in use <br  />
 </p>

</div>
</div>
<a id="ga6e0d2dbb6d41eedb0eb6597f9b7073a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6e0d2dbb6d41eedb0eb6597f9b7073a8">&#9670;&nbsp;</a></span>next</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsrtp__policy__t.html">srtp_policy_t</a>* srtp_policy_t::next</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pointer to next stream policy. <br  />
 </p>

</div>
</div>
<a id="ga726519472469427aeab76dfec28fabc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga726519472469427aeab76dfec28fabc1">&#9670;&nbsp;</a></span>num_master_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_policy_t::num_master_keys</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Array of Master Key structures <br  />
 </p>

</div>
</div>
<a id="gaa1847e6734f709f86e79d0600bc4f24f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1847e6734f709f86e79d0600bc4f24f">&#9670;&nbsp;</a></span>rtcp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsrtp__crypto__policy__t.html">srtp_crypto_policy_t</a> srtp_policy_t::rtcp</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SRTCP crypto policy. <br  />
 </p>

</div>
</div>
<a id="ga7a2bce58e854e44e6d449ec7141b33e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a2bce58e854e44e6d449ec7141b33e2">&#9670;&nbsp;</a></span>rtp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsrtp__crypto__policy__t.html">srtp_crypto_policy_t</a> srtp_policy_t::rtp</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SRTP crypto policy. <br  />
 </p>

</div>
</div>
<a id="ga407b35adb46bf372962c466ba60ee76d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga407b35adb46bf372962c466ba60ee76d">&#9670;&nbsp;</a></span>sec_serv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#gaa27b90c4ad1bc3e874ec8baa805528e2">srtp_sec_serv_t</a> srtp_crypto_policy_t::sec_serv</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The flag indicating the security services to be applied. <br  />
 </p>

</div>
</div>
<a id="ga1ad798f300e1f0cb78faa415f51e7dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1ad798f300e1f0cb78faa415f51e7dde">&#9670;&nbsp;</a></span>session</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#ga1c404a756add908efb805d6b729994d0">srtp_t</a> srtp_event_data_t::session</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The session in which the event happened. <br  />
 </p>

</div>
</div>
<a id="gac75ef5b52a26ff6a3fe22047ba16add5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac75ef5b52a26ff6a3fe22047ba16add5">&#9670;&nbsp;</a></span>ssrc <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsrtp__ssrc__t.html">srtp_ssrc_t</a> srtp_policy_t::ssrc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The SSRC value of stream, or the <br  />
 flags SSRC_ANY_INBOUND or <br  />
 SSRC_ANY_OUTBOUND if key sharing <br  />
 is used for this policy element. <br  />
 </p>

</div>
</div>
<a id="gac364ee9d9a3c2c49aba31967925bced5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac364ee9d9a3c2c49aba31967925bced5">&#9670;&nbsp;</a></span>ssrc <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t srtp_event_data_t::ssrc</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The ssrc in host order of the stream in which <br  />
 the event happened <br  />
 </p>

</div>
</div>
<a id="gaa68453a1aad5a06c462b9ece9899e571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa68453a1aad5a06c462b9ece9899e571">&#9670;&nbsp;</a></span>type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__SRTP.html#ga5f645f22b51783c17b084572a3c821a2">srtp_ssrc_type_t</a> srtp_ssrc_t::type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The type of this particular SSRC </p>

</div>
</div>
<a id="gac67dc27a66ff404cadecf1bc4b194843"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac67dc27a66ff404cadecf1bc4b194843">&#9670;&nbsp;</a></span>use_mki</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool srtp_policy_t::use_mki</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of master keys <br  />
 </p>

</div>
</div>
<a id="ga63122ff062c3514a84dfd255e7882ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga63122ff062c3514a84dfd255e7882ceb">&#9670;&nbsp;</a></span>value</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t srtp_ssrc_t::value</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The value of this SSRC, if it is not a wildcard </p>

</div>
</div>
<a id="ga9f4319a87f06d8e3edabeb4ffe3390b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f4319a87f06d8e3edabeb4ffe3390b2">&#9670;&nbsp;</a></span>window_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t srtp_policy_t::window_size</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Size of MKI when in use <br  />
 The window size to use for replay <br  />
 protection. <br  />
 </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
